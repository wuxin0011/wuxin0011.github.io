<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue3自定义权限指令 | wuxin0011`blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <link rel="icon" href="/icon/logo.ico">
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.css">
    <script rel="stylesheet" src="https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.js" crossorigin="anonymous"></script>
    <script rel="stylesheet" src="https://cdn.bootcdn.net/ajax/libs/meting/2.0.1/Meting.min.js" crossorigin="anonymous"></script>
    <script rel="stylesheet" src="https://cdn.bootcdn.net/ajax/libs/busuanzi/2.3.0/bsz.pure.mini.min.js" crossorigin="anonymous"></script>
    <script data-ad-client="ca-pub-7828333725993554" async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/twikoo/1.6.20/twikoo.all.min.js"></script>
    <meta name="description" content="欢迎访问个人静态网站">
    <meta name="keywords" content="欢迎访问个人博客">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.862d7d54.css" as="style"><link rel="preload" href="/assets/js/app.f77a8ef1.js" as="script"><link rel="preload" href="/assets/js/2.a8c56b49.js" as="script"><link rel="preload" href="/assets/js/59.53ae0f36.js" as="script"><link rel="preload" href="/assets/js/5.a24cbcf3.js" as="script"><link rel="preload" href="/assets/js/6.c8f6b87d.js" as="script"><link rel="preload" href="/assets/js/8.aaf722de.js" as="script"><link rel="preload" href="/assets/js/13.7f9001b0.js" as="script"><link rel="preload" href="/assets/js/9.c3d06476.js" as="script"><link rel="prefetch" href="/assets/js/10.c0149292.js"><link rel="prefetch" href="/assets/js/100.b3512a6b.js"><link rel="prefetch" href="/assets/js/101.8660af48.js"><link rel="prefetch" href="/assets/js/102.c615d4a1.js"><link rel="prefetch" href="/assets/js/103.02e7e4a7.js"><link rel="prefetch" href="/assets/js/104.fddce748.js"><link rel="prefetch" href="/assets/js/105.63d8d893.js"><link rel="prefetch" href="/assets/js/106.fa87aa99.js"><link rel="prefetch" href="/assets/js/107.b083bdf8.js"><link rel="prefetch" href="/assets/js/108.963202cb.js"><link rel="prefetch" href="/assets/js/109.cd5e9128.js"><link rel="prefetch" href="/assets/js/11.4abefbd1.js"><link rel="prefetch" href="/assets/js/110.69e743e7.js"><link rel="prefetch" href="/assets/js/111.016dc38d.js"><link rel="prefetch" href="/assets/js/112.46715142.js"><link rel="prefetch" href="/assets/js/113.d3302260.js"><link rel="prefetch" href="/assets/js/114.c8e3f749.js"><link rel="prefetch" href="/assets/js/115.312ea26e.js"><link rel="prefetch" href="/assets/js/116.9464a84e.js"><link rel="prefetch" href="/assets/js/117.7b68a16a.js"><link rel="prefetch" href="/assets/js/118.9bf784a2.js"><link rel="prefetch" href="/assets/js/119.d0ddf492.js"><link rel="prefetch" href="/assets/js/12.8f66d61d.js"><link rel="prefetch" href="/assets/js/120.4b0ce519.js"><link rel="prefetch" href="/assets/js/121.a913f1a9.js"><link rel="prefetch" href="/assets/js/122.ec74b06a.js"><link rel="prefetch" href="/assets/js/123.cfde6750.js"><link rel="prefetch" href="/assets/js/124.346e117b.js"><link rel="prefetch" href="/assets/js/125.d9ce763a.js"><link rel="prefetch" href="/assets/js/126.6a775341.js"><link rel="prefetch" href="/assets/js/127.ae9c4b24.js"><link rel="prefetch" href="/assets/js/128.9ca535aa.js"><link rel="prefetch" href="/assets/js/129.c9728452.js"><link rel="prefetch" href="/assets/js/130.54084249.js"><link rel="prefetch" href="/assets/js/131.b626e9da.js"><link rel="prefetch" href="/assets/js/132.6f1cfd82.js"><link rel="prefetch" href="/assets/js/133.5048162e.js"><link rel="prefetch" href="/assets/js/134.41b25ece.js"><link rel="prefetch" href="/assets/js/135.ec46eaab.js"><link rel="prefetch" href="/assets/js/136.b81f4326.js"><link rel="prefetch" href="/assets/js/137.349955d5.js"><link rel="prefetch" href="/assets/js/138.6c637135.js"><link rel="prefetch" href="/assets/js/139.bb4f3421.js"><link rel="prefetch" href="/assets/js/14.f928199b.js"><link rel="prefetch" href="/assets/js/140.ac3e53fb.js"><link rel="prefetch" href="/assets/js/141.4e187a2c.js"><link rel="prefetch" href="/assets/js/142.a37b90ef.js"><link rel="prefetch" href="/assets/js/143.e583a586.js"><link rel="prefetch" href="/assets/js/144.fd47dfb8.js"><link rel="prefetch" href="/assets/js/145.1e2ea979.js"><link rel="prefetch" href="/assets/js/146.b3ecb59a.js"><link rel="prefetch" href="/assets/js/147.bcedf411.js"><link rel="prefetch" href="/assets/js/148.a93c7b0a.js"><link rel="prefetch" href="/assets/js/149.7c0f09b2.js"><link rel="prefetch" href="/assets/js/15.c17796b2.js"><link rel="prefetch" href="/assets/js/150.40ceb746.js"><link rel="prefetch" href="/assets/js/151.ed398750.js"><link rel="prefetch" href="/assets/js/152.4f095724.js"><link rel="prefetch" href="/assets/js/153.c9116f63.js"><link rel="prefetch" href="/assets/js/154.7a3c43ae.js"><link rel="prefetch" href="/assets/js/155.3a6e825b.js"><link rel="prefetch" href="/assets/js/156.1bcd81ae.js"><link rel="prefetch" href="/assets/js/157.e3e713cd.js"><link rel="prefetch" href="/assets/js/158.92a93907.js"><link rel="prefetch" href="/assets/js/159.19bad34f.js"><link rel="prefetch" href="/assets/js/16.89c43fdf.js"><link rel="prefetch" href="/assets/js/160.012109cc.js"><link rel="prefetch" href="/assets/js/161.80683ddd.js"><link rel="prefetch" href="/assets/js/162.600b2d19.js"><link rel="prefetch" href="/assets/js/163.ccf9e630.js"><link rel="prefetch" href="/assets/js/164.dab23a05.js"><link rel="prefetch" href="/assets/js/165.40da9f5c.js"><link rel="prefetch" href="/assets/js/166.44c0801e.js"><link rel="prefetch" href="/assets/js/167.12409f08.js"><link rel="prefetch" href="/assets/js/168.5d4b6836.js"><link rel="prefetch" href="/assets/js/169.cdfe8fd7.js"><link rel="prefetch" href="/assets/js/17.5fdab0c2.js"><link rel="prefetch" href="/assets/js/170.846300f9.js"><link rel="prefetch" href="/assets/js/171.218ab4ae.js"><link rel="prefetch" href="/assets/js/172.d49ce817.js"><link rel="prefetch" href="/assets/js/173.7185d90b.js"><link rel="prefetch" href="/assets/js/174.f6728d6e.js"><link rel="prefetch" href="/assets/js/175.9bc9b89e.js"><link rel="prefetch" href="/assets/js/176.a52d25b2.js"><link rel="prefetch" href="/assets/js/177.4a832a3d.js"><link rel="prefetch" href="/assets/js/178.25797ff1.js"><link rel="prefetch" href="/assets/js/179.dfaaa892.js"><link rel="prefetch" href="/assets/js/18.8eafecfe.js"><link rel="prefetch" href="/assets/js/180.71243a84.js"><link rel="prefetch" href="/assets/js/181.1686b09f.js"><link rel="prefetch" href="/assets/js/182.18fece6c.js"><link rel="prefetch" href="/assets/js/183.1a564390.js"><link rel="prefetch" href="/assets/js/184.ca4d287d.js"><link rel="prefetch" href="/assets/js/185.5523749f.js"><link rel="prefetch" href="/assets/js/186.8fafdee9.js"><link rel="prefetch" href="/assets/js/187.95558ab1.js"><link rel="prefetch" href="/assets/js/188.89e3432f.js"><link rel="prefetch" href="/assets/js/189.bc7d6d8b.js"><link rel="prefetch" href="/assets/js/19.2db54fe3.js"><link rel="prefetch" href="/assets/js/190.6dd5954d.js"><link rel="prefetch" href="/assets/js/191.a5d22db1.js"><link rel="prefetch" href="/assets/js/192.8c308b11.js"><link rel="prefetch" href="/assets/js/193.8466601a.js"><link rel="prefetch" href="/assets/js/194.42ac4daa.js"><link rel="prefetch" href="/assets/js/195.34803c7e.js"><link rel="prefetch" href="/assets/js/196.c695672b.js"><link rel="prefetch" href="/assets/js/197.7574dc83.js"><link rel="prefetch" href="/assets/js/198.2309f6a4.js"><link rel="prefetch" href="/assets/js/199.f5dac05e.js"><link rel="prefetch" href="/assets/js/20.d70d938a.js"><link rel="prefetch" href="/assets/js/200.9b64dce9.js"><link rel="prefetch" href="/assets/js/201.595a8e60.js"><link rel="prefetch" href="/assets/js/202.fe9047db.js"><link rel="prefetch" href="/assets/js/203.8c86c8cc.js"><link rel="prefetch" href="/assets/js/204.fa057448.js"><link rel="prefetch" href="/assets/js/205.402d3685.js"><link rel="prefetch" href="/assets/js/206.f4a2dda8.js"><link rel="prefetch" href="/assets/js/207.41577fc0.js"><link rel="prefetch" href="/assets/js/208.dad67cc6.js"><link rel="prefetch" href="/assets/js/209.181298ba.js"><link rel="prefetch" href="/assets/js/21.a09dafe3.js"><link rel="prefetch" href="/assets/js/210.b7639d86.js"><link rel="prefetch" href="/assets/js/211.00f891c9.js"><link rel="prefetch" href="/assets/js/212.7405200e.js"><link rel="prefetch" href="/assets/js/213.6f9db149.js"><link rel="prefetch" href="/assets/js/22.f58b5322.js"><link rel="prefetch" href="/assets/js/23.0d8ba6e4.js"><link rel="prefetch" href="/assets/js/24.4c643629.js"><link rel="prefetch" href="/assets/js/25.b669f7ad.js"><link rel="prefetch" href="/assets/js/26.e5b16073.js"><link rel="prefetch" href="/assets/js/27.4629d9d0.js"><link rel="prefetch" href="/assets/js/28.7af9b2d0.js"><link rel="prefetch" href="/assets/js/29.5d99b677.js"><link rel="prefetch" href="/assets/js/3.d99c2bb3.js"><link rel="prefetch" href="/assets/js/30.3f444167.js"><link rel="prefetch" href="/assets/js/31.50c0673e.js"><link rel="prefetch" href="/assets/js/32.e088b8d1.js"><link rel="prefetch" href="/assets/js/33.476b49f9.js"><link rel="prefetch" href="/assets/js/34.ee9a442e.js"><link rel="prefetch" href="/assets/js/35.47091cc8.js"><link rel="prefetch" href="/assets/js/36.fd50f374.js"><link rel="prefetch" href="/assets/js/37.6110874d.js"><link rel="prefetch" href="/assets/js/38.cd817cea.js"><link rel="prefetch" href="/assets/js/39.3258df58.js"><link rel="prefetch" href="/assets/js/4.e5d960b5.js"><link rel="prefetch" href="/assets/js/40.c5005332.js"><link rel="prefetch" href="/assets/js/41.f2487f7c.js"><link rel="prefetch" href="/assets/js/42.979e5424.js"><link rel="prefetch" href="/assets/js/43.28df40c9.js"><link rel="prefetch" href="/assets/js/44.8b777c99.js"><link rel="prefetch" href="/assets/js/45.36e59bb7.js"><link rel="prefetch" href="/assets/js/46.8e704a8a.js"><link rel="prefetch" href="/assets/js/47.ae963466.js"><link rel="prefetch" href="/assets/js/48.e1cd709e.js"><link rel="prefetch" href="/assets/js/49.352eb6a9.js"><link rel="prefetch" href="/assets/js/50.6af1fc83.js"><link rel="prefetch" href="/assets/js/51.0907903e.js"><link rel="prefetch" href="/assets/js/52.1b1b883c.js"><link rel="prefetch" href="/assets/js/53.8997a9fb.js"><link rel="prefetch" href="/assets/js/54.cec90ea7.js"><link rel="prefetch" href="/assets/js/55.fd1d717c.js"><link rel="prefetch" href="/assets/js/56.94fb9c3b.js"><link rel="prefetch" href="/assets/js/57.2c5f7ab7.js"><link rel="prefetch" href="/assets/js/58.351f8291.js"><link rel="prefetch" href="/assets/js/60.2fb7570a.js"><link rel="prefetch" href="/assets/js/61.a55e3db1.js"><link rel="prefetch" href="/assets/js/62.bda57941.js"><link rel="prefetch" href="/assets/js/63.57f644b2.js"><link rel="prefetch" href="/assets/js/64.d95360e2.js"><link rel="prefetch" href="/assets/js/65.cac4e0fe.js"><link rel="prefetch" href="/assets/js/66.1c1b05fe.js"><link rel="prefetch" href="/assets/js/67.955c028d.js"><link rel="prefetch" href="/assets/js/68.d884e071.js"><link rel="prefetch" href="/assets/js/69.26bf943c.js"><link rel="prefetch" href="/assets/js/7.a90b063f.js"><link rel="prefetch" href="/assets/js/70.6154ab4b.js"><link rel="prefetch" href="/assets/js/71.0a83e5e2.js"><link rel="prefetch" href="/assets/js/72.91aef513.js"><link rel="prefetch" href="/assets/js/73.5efc8e1b.js"><link rel="prefetch" href="/assets/js/74.07ee57fa.js"><link rel="prefetch" href="/assets/js/75.a8382f05.js"><link rel="prefetch" href="/assets/js/76.15806e69.js"><link rel="prefetch" href="/assets/js/77.92096ac8.js"><link rel="prefetch" href="/assets/js/78.0bc8c3e1.js"><link rel="prefetch" href="/assets/js/79.cfb757ac.js"><link rel="prefetch" href="/assets/js/80.9a6fc6f9.js"><link rel="prefetch" href="/assets/js/81.f211af0e.js"><link rel="prefetch" href="/assets/js/82.a4398445.js"><link rel="prefetch" href="/assets/js/83.0913354e.js"><link rel="prefetch" href="/assets/js/84.96db0d18.js"><link rel="prefetch" href="/assets/js/85.8ec1dc29.js"><link rel="prefetch" href="/assets/js/86.198ef6d4.js"><link rel="prefetch" href="/assets/js/87.6b0eb81f.js"><link rel="prefetch" href="/assets/js/88.714d7276.js"><link rel="prefetch" href="/assets/js/89.a2e70edf.js"><link rel="prefetch" href="/assets/js/90.90edbe44.js"><link rel="prefetch" href="/assets/js/91.9c05dbc5.js"><link rel="prefetch" href="/assets/js/92.99a33f63.js"><link rel="prefetch" href="/assets/js/93.e1953cf5.js"><link rel="prefetch" href="/assets/js/94.099f2edd.js"><link rel="prefetch" href="/assets/js/95.da1677c4.js"><link rel="prefetch" href="/assets/js/96.e1f7c8f9.js"><link rel="prefetch" href="/assets/js/97.12857c16.js"><link rel="prefetch" href="/assets/js/98.57753d02.js"><link rel="prefetch" href="/assets/js/99.39831736.js">
    <link rel="stylesheet" href="/assets/css/0.styles.862d7d54.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/picgo/icon.png" alt="wuxin0011`blog" class="logo"> <span class="site-name can-hide">wuxin0011`blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础内容</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>进阶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">JavaScript教程</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">ES6 教程</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">React</a></li><li class="dropdown-subitem"><a href="/note/typescript/" class="nav-link">Typescript</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">Git</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/admin/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/java-recommend/" class="nav-link">推荐阅读</a></li><li class="dropdown-item"><!----> <a href="/java/java-collection/" class="nav-link">java随笔</a></li><li class="dropdown-item"><!----> <a href="https://wuxin0011.github.io/jvm-learn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JVM
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/technology/git-use/" class="nav-link">git使用</a></li><li class="dropdown-item"><!----> <a href="/technology/deploy-ruoyi-cloud/" class="nav-link">docker部署项目</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="小工具" class="dropdown-title"><a href="/tools/" class="link-title">小工具</a> <span class="title" style="display:none;">小工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/github-start-project/" class="nav-link">github-start</a></li><li class="dropdown-item"><!----> <a href="/tools/background-color/" class="nav-link">background-color</a></li><li class="dropdown-item"><!----> <a href="/tools/node-live-serve/" class="nav-link">live-server</a></li><li class="dropdown-item"><!----> <a href="https://wuxin0011.github.io/tampermonkey-script/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  tampermonkey-script
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><!----> <span class="title" style="display:;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/collection/website/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/collection/front/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/collection/admin/" class="nav-link">后端</a></li><li class="dropdown-item"><!----> <a href="https://github.com/topics" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github Topic
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/wuxin0011/wuxin0011.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://avatars.githubusercontent.com/u/65836396?v=4"> <div class="blogger-info"><h3>wuxin0011</h3> <span>懂得越多，懂得越少</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/web/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础内容</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/8309a5b876fc95e3/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/pages/0a83b083bdf257cb/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/note/js/" class="nav-link">JavaScript</a></li></ul></li><li class="dropdown-item"><h4>进阶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/note/javascript/" class="nav-link">JavaScript教程</a></li><li class="dropdown-subitem"><a href="/note/es6/" class="nav-link">ES6 教程</a></li><li class="dropdown-subitem"><a href="/note/vue/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/note/react/" class="nav-link">React</a></li><li class="dropdown-subitem"><a href="/note/typescript/" class="nav-link">Typescript</a></li><li class="dropdown-subitem"><a href="/note/git/" class="nav-link">Git</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><a href="/admin/" class="link-title">后端</a> <span class="title" style="display:none;">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/java-recommend/" class="nav-link">推荐阅读</a></li><li class="dropdown-item"><!----> <a href="/java/java-collection/" class="nav-link">java随笔</a></li><li class="dropdown-item"><!----> <a href="https://wuxin0011.github.io/jvm-learn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  JVM
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/aea6571b7a8bae86/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术" class="dropdown-title"><a href="/technology/" class="link-title">技术</a> <span class="title" style="display:none;">技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/technology/git-use/" class="nav-link">git使用</a></li><li class="dropdown-item"><!----> <a href="/technology/deploy-ruoyi-cloud/" class="nav-link">docker部署项目</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="小工具" class="dropdown-title"><a href="/tools/" class="link-title">小工具</a> <span class="title" style="display:none;">小工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/github-start-project/" class="nav-link">github-start</a></li><li class="dropdown-item"><!----> <a href="/tools/background-color/" class="nav-link">background-color</a></li><li class="dropdown-item"><!----> <a href="/tools/node-live-serve/" class="nav-link">live-server</a></li><li class="dropdown-item"><!----> <a href="https://wuxin0011.github.io/tampermonkey-script/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  tampermonkey-script
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><!----> <span class="title" style="display:;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/collection/website/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/collection/front/" class="nav-link">前端</a></li><li class="dropdown-item"><!----> <a href="/collection/admin/" class="nav-link">后端</a></li><li class="dropdown-item"><!----> <a href="https://github.com/topics" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github Topic
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/wuxin0011/wuxin0011.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript文章</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>学习笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端随笔</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/bem/" class="sidebar-link">css之bem架构</a></li><li><a href="/pages/custom-vue-admin-directive/" aria-current="page" class="active sidebar-link">vue3自定义权限指令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/custom-vue-admin-directive/#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header level2"><a href="/pages/custom-vue-admin-directive/#内容" class="sidebar-link">内容</a></li><li class="sidebar-sub-header level2"><a href="/pages/custom-vue-admin-directive/#相关链接" class="sidebar-link">相关链接</a></li></ul></li><li><a href="/pages/dhfna5234ew/" class="sidebar-link">使用Gtihub api 获取用户star项目</a></li><li><a href="/pages/twikoo-comment/" class="sidebar-link">评论实现改为云函数</a></li><li><a href="/pages/theme-snapshot/" class="sidebar-link">主题快照</a></li><li><a href="/pages/front-static-project-decrypt/" class="sidebar-link">静态前端项目密码破解</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-1"><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/web/#前端" data-v-06225672>前端</a></li><li data-v-06225672><a href="/web/#前端随笔" data-v-06225672>前端随笔</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/wuxin0011" target="_blank" title="作者" class="beLink" data-v-06225672>wuxin0011</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-05-06</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">vue3自定义权限指令<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>关于<code>Vue</code>自定义指令网上一搜估计一大堆，但是我想尝试自己写一个，除了看了官方文档，其他都没有借鉴过！</p></div> <p>哎，脑壳疼，第一次写这种自定义指令，就是一堆字符串比对！本来用正则匹配来判断，测试之后发现有些问题，没办法，只能换了。本来也可以不用写这么多，但是为了兼容多种写法，只能做不同处理了，目前基本完成了判断。最好说下 <code>Ts</code> fuck!。</p> <ul><li>对象式写法</li> <li>连写式写法</li> <li>混合式写法</li></ul> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>具体用法看内容。后续可能会修改</p></div> <h2 id="内容"><a href="#内容" class="header-anchor">#</a> 内容</h2> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> isArray<span class="token punctuation">,</span> isEmptyObject<span class="token punctuation">,</span> isString<span class="token punctuation">,</span> isUndefined<span class="token punctuation">,</span> isObject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./../utils/validate'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Directive<span class="token punctuation">,</span> DirectiveBinding <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token comment">/** 
 * 自定义权限指令 
 * 
 *  第一个 * 表示角色 ,第二个 * 表示资源，第三个 * 表示具体权限
 * 
 *       三指令用法 针对角色和权限的某一权限
 *  
 *          任意角色都能访问                        *:*:*                                 v-permission.*:*:*=&quot;*:*:*&quot;    一般省略,因为这样毫无意义！
 *          具有 admin 角色才能访问                 admin:*:*                             v-permission.admin:*:*=&quot;xxx&quot; 
 *          具有 add 权限才能访问                   *:*:add                               v-permission.*:*:add=&quot;*:*:xxx&quot;
 *          具有 xxx 资源下任意权限                 *:xxx:*                                v-permission.*:blog:*=&quot;*:xxx&quot;
 *          具有 xxx 资源权限同时要有add权限         *:xx:add                              v-permission.admin:blog:add=&quot;xxx:yyy:zzz&quot;
 * 
 *       双指令写法，针对角色和资源 ,省略具体权限
 *              
 *            某一个角色具有某一资源下所有权限    v-permission.admin:blog.user:blog        
 * 
 *        单指令写法，省略资源和具体权限
 *            多个角色 连写形式                  v-permission.admin.user.other              admin | user | other  都能访问        
 *                                           
 * 
 * 
 * 对象式写法
 *  v-permission=&quot;[{ type: 'serve', role: [], resource: [], permission: [] }, { type: 'expect', role: ['admin'], resource: [], permission: ['add'] }]&quot;
 *  参数说明: type 指定为说明类型，默认可以不指定，第一个式前端接受类型，第二个期望式什么类型
 *                 - 如果指定了类型，两个类型不能一致！，否则会覆盖！
 *                 - expect  期望类型
 *                 - serve   从服务端接受的权限
 *            role: 角色 
 *                 - 如果是一个字符串，可以省略 [&quot;admin&quot;] =&gt; &quot;admin&quot;
 *                 - 多个角色使用数组形式 [&quot;admin&quot;,&quot;user&quot;]
 *                 - 如果省略,默认式为 *
 *            resource: 资源 
 *                 - 同上
 *            permission: 具体权限
 *                 - 同上
 * 
 * 
 * 混合式写法
 * 
 * 参考上面两种方式
 * 只能通过  v-permission.xxxx:yyyy:zzz=&quot;{role: aaa, resource: bbbb, permission: cccc }&quot;
 * - role,resource,permission 省略表示 *
 * 
 * 
 * 判断依据
 *    - 如果不指定对应资源默认值，初始化设置为 &quot;*&quot;
 *    - 如果一个资源权限对应设置为 &quot;*&quot;,对于期望值来说，可以放行任意权限，对于服务器接收数据来说，表示具有任意权限
 *         - 例如 [&quot;admin:*:*&quot;] === [&quot;*&quot;:&quot;*&quot;:&quot;add&quot;] = &gt;true
 *         - 例如 [&quot;*:*:add&quot;] ===   [&quot;user&quot;:&quot;*&quot;:&quot;add&quot;] = &gt;true
 *         - 例如 [&quot;*:*:add&quot;] ===   [&quot;user&quot;:&quot;*&quot;:&quot;delete&quot;] = &gt;false
 *         - 例如 [&quot;*:account:add&quot;] ===   [&quot;user&quot;:&quot;picture&quot;:&quot;add&quot;] = &gt;false
 * 
 */</span>




<span class="token comment">// 所有权限</span>
<span class="token keyword">const</span> <span class="token constant">ANY_PERMISSION</span> <span class="token operator">=</span> <span class="token string">&quot;*&quot;</span>
<span class="token comment">// 权限连接符</span>
<span class="token keyword">const</span> <span class="token constant">PERMISSION_CONNECTION</span> <span class="token operator">=</span> <span class="token string">&quot;:&quot;</span>


<span class="token keyword">type</span> <span class="token class-name">PermssionTypeStr</span> <span class="token operator">=</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token keyword">undefined</span>

<span class="token comment">/**
 * 权限类型
 */</span>
<span class="token keyword">const</span> <span class="token constant">RESOLVE_SERVE</span> <span class="token operator">=</span> <span class="token string">'server'</span>
<span class="token keyword">const</span> <span class="token constant">RESOLVE_EXPECT</span> <span class="token operator">=</span> <span class="token string">'expect'</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">ResolvePermssionType</span> <span class="token operator">=</span> <span class="token string">'expect'</span> <span class="token operator">|</span> <span class="token string">'server'</span> <span class="token operator">|</span> <span class="token keyword">undefined</span>

<span class="token keyword">interface</span> <span class="token class-name">Permssion</span> <span class="token punctuation">{</span>
    role<span class="token operator">?</span><span class="token operator">:</span> PermssionTypeStr
    resource<span class="token operator">?</span><span class="token operator">:</span> PermssionTypeStr
    permission<span class="token operator">?</span><span class="token operator">:</span> PermssionTypeStr
<span class="token punctuation">}</span>


<span class="token comment">/**
 * 权限对象式写法类型
 */</span>
<span class="token keyword">interface</span> <span class="token class-name">PermssionType</span> <span class="token keyword">extends</span> <span class="token class-name">Permssion</span> <span class="token punctuation">{</span>
    type<span class="token operator">?</span><span class="token operator">:</span> ResolvePermssionType
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">initParams</span> <span class="token operator">=</span> <span class="token punctuation">(</span>obj<span class="token operator">:</span> Permssion<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndefined</span><span class="token punctuation">(</span>obj<span class="token operator">?.</span>role<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        obj<span class="token punctuation">[</span><span class="token string">'role'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">ANY_PERMISSION</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndefined</span><span class="token punctuation">(</span>obj<span class="token operator">?.</span>resource<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        obj<span class="token punctuation">[</span><span class="token string">'resource'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">ANY_PERMISSION</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndefined</span><span class="token punctuation">(</span>obj<span class="token operator">?.</span>permission<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        obj<span class="token punctuation">[</span><span class="token string">'permission'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">ANY_PERMISSION</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">const</span> <span class="token function-variable function">compareArrayPermission</span> <span class="token operator">=</span> <span class="token punctuation">(</span>expect<span class="token operator">:</span> PermssionTypeStr<span class="token punctuation">,</span> server<span class="token operator">:</span> PermssionTypeStr<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>expect<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isArray</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        expect <span class="token operator">=</span> expect <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        server <span class="token operator">=</span> server <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token generic-function"><span class="token function">i</span> <span class="token generic class-name"><span class="token operator">&lt;</span> server<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 如果用户具有 任意权限放行</span>
            <span class="token comment">// 如果资源对任意用户访问，放行</span>
            <span class="token keyword">let</span> index <span class="token operator">=</span> expect<span class="token punctuation">.</span><span class="token function">findIndex</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span></span></span>
                <span class="token punctuation">(</span>
                    item
                    <span class="token operator">&amp;&amp;</span>
                    server
                    <span class="token operator">&amp;&amp;</span>
                    item <span class="token operator">===</span> <span class="token punctuation">(</span>server <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token operator">||</span>
                item <span class="token operator">===</span> <span class="token constant">ANY_PERMISSION</span>
                <span class="token operator">||</span>
                <span class="token punctuation">(</span>server <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token constant">ANY_PERMISSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>expect<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果包含任意权限放行</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>expect <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>e <span class="token operator">=&gt;</span> e <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>e <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant">ANY_PERMISSION</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>server <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant">ANY_PERMISSION</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 从 s2 是否具有s1权限</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>expect <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>server <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果包含任意权限放行</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>server <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>e <span class="token operator">=&gt;</span> e <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>e <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant">ANY_PERMISSION</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>expect <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant">ANY_PERMISSION</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 从 s2 是否具有s1权限</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>server <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>expect <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>


<span class="token comment">/**
 * 单个权限比对
 * @param expect 期望权限
 * @param server 服务器接受权限
 * @returns 
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">hasPermission</span> <span class="token operator">=</span> <span class="token punctuation">(</span>expect<span class="token operator">:</span> PermssionTypeStr<span class="token punctuation">,</span> server<span class="token operator">:</span> PermssionTypeStr<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'expect'</span><span class="token punctuation">,</span> expect<span class="token punctuation">,</span> <span class="token string">'server'</span><span class="token punctuation">,</span> server<span class="token punctuation">)</span>
    <span class="token comment">// 如果具有多个权限或者角色</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>expect<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isArray</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">compareArrayPermission</span><span class="token punctuation">(</span>expect<span class="token punctuation">,</span> server<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 如果允许任意权限 或者具有任意权限</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>expect <span class="token operator">===</span> <span class="token constant">ANY_PERMISSION</span> <span class="token operator">||</span> server <span class="token operator">===</span> <span class="token constant">ANY_PERMISSION</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> expect <span class="token operator">===</span> server
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 权限比对
 * @param expect 期望权限
 * @param server 接受权限
 * @returns boolean
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">hasAllPermission</span> <span class="token operator">=</span> <span class="token punctuation">(</span>expect<span class="token operator">:</span> Permssion<span class="token punctuation">,</span> server<span class="token operator">:</span> Permssion<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">hasPermission</span><span class="token punctuation">(</span>expect<span class="token operator">?.</span>role<span class="token punctuation">,</span> server<span class="token operator">?.</span>role<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">hasPermission</span><span class="token punctuation">(</span>expect<span class="token operator">?.</span>resource<span class="token punctuation">,</span> server<span class="token operator">?.</span>resource<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">hasPermission</span><span class="token punctuation">(</span>expect<span class="token operator">?.</span>permission<span class="token punctuation">,</span> server<span class="token operator">?.</span>permission<span class="token punctuation">)</span>


<span class="token keyword">const</span> pa <span class="token operator">=</span> <span class="token punctuation">(</span>o<span class="token operator">:</span> PermssionTypeStr<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">&amp;&amp;</span> <span class="token function">isArray</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>o <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> o <span class="token keyword">as</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">permssionStr</span> <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">:</span> Permssion<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">pa</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>role<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PERMISSION_CONNECTION</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">pa</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>resource<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token constant">PERMISSION_CONNECTION</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">pa</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>permission<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token keyword">const</span> <span class="token function-variable function">printPermission</span> <span class="token operator">=</span> <span class="token punctuation">(</span>expect<span class="token operator">:</span> Permssion<span class="token punctuation">,</span> server<span class="token operator">:</span> Permssion<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'期望类型'</span><span class="token punctuation">,</span> <span class="token function">permssionStr</span><span class="token punctuation">(</span>expect<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'服务器接受类型'</span><span class="token punctuation">,</span> <span class="token function">permssionStr</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">alertPermission</span> <span class="token operator">=</span> <span class="token punctuation">(</span>params1<span class="token operator">:</span> Permssion<span class="token punctuation">,</span> params2<span class="token operator">:</span> Permssion<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> space <span class="token operator">=</span> <span class="token string">'    '</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'期望类型'</span><span class="token operator">:</span> space <span class="token operator">+</span> <span class="token function">permssionStr</span><span class="token punctuation">(</span>params1<span class="token punctuation">)</span> <span class="token operator">+</span> space<span class="token punctuation">,</span>
        <span class="token string-property property">'接受类型'</span><span class="token operator">:</span> space <span class="token operator">+</span> <span class="token function">permssionStr</span><span class="token punctuation">(</span>params2<span class="token punctuation">)</span> <span class="token operator">+</span> space
    <span class="token punctuation">}</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 生成 权限对象</span>
<span class="token keyword">const</span> getPermission <span class="token operator">=</span> <span class="token punctuation">(</span>params<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> Permssion <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> arr <span class="token operator">=</span> params<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token constant">PERMISSION_CONNECTION</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> arr<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isArray</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'指令解析失败!'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> p<span class="token operator">:</span> Permssion <span class="token operator">=</span> <span class="token punctuation">{</span>
        role<span class="token operator">:</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        resource<span class="token operator">:</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        permission<span class="token operator">:</span> arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> p
<span class="token punctuation">}</span>

<span class="token comment">// 将字符串转换成 权限字符</span>
<span class="token keyword">const</span> addPermission <span class="token operator">=</span> <span class="token punctuation">(</span>args<span class="token operator">:</span> PermssionTypeStr<span class="token punctuation">)</span><span class="token operator">:</span> Permssion <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isString</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token punctuation">(</span>args <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token constant">PERMISSION_CONNECTION</span><span class="token punctuation">,</span> <span class="token string">&quot;g&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">// 匹配到一个:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> i<span class="token operator">!</span><span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            args <span class="token operator">=</span> args <span class="token operator">+</span> <span class="token constant">PERMISSION_CONNECTION</span> <span class="token operator">+</span> <span class="token constant">ANY_PERMISSION</span>
            <span class="token comment">// 匹配到两个 ：</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> i<span class="token operator">!</span><span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// 一个都没匹配到</span>
            args <span class="token operator">=</span> args <span class="token operator">+</span> <span class="token constant">PERMISSION_CONNECTION</span> <span class="token operator">+</span> <span class="token constant">ANY_PERMISSION</span> <span class="token operator">+</span> <span class="token constant">PERMISSION_CONNECTION</span> <span class="token operator">+</span> <span class="token constant">ANY_PERMISSION</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">getPermission</span><span class="token punctuation">(</span>args <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">as</span> Permssion
<span class="token punctuation">}</span>


<span class="token comment">// 生成权限</span>
<span class="token keyword">const</span> genRoles <span class="token operator">=</span> <span class="token punctuation">(</span>args<span class="token operator">:</span> PermssionTypeStr<span class="token punctuation">)</span><span class="token operator">:</span> Permssion<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isString</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token function">addPermission</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        args <span class="token operator">=</span> args <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">return</span> args<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>arg <span class="token operator">=&gt;</span> <span class="token function">addPermission</span><span class="token punctuation">(</span>arg <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">as</span> Permssion<span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 权限去重</span>
<span class="token keyword">const</span> duplicateRemoval <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">:</span> Permssion<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> Permssion <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> roles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> resources <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> permissions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> obj<span class="token operator">:</span> Permssion

    p<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        roles<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'role'</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
        resources<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'resource'</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
        permissions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'permission'</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">// set 去重</span>
    roles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>roles<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    resources <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>resources<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    permissions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>permissions<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token comment">// 是否存在最高权限</span>
    roles <span class="token operator">=</span> roles<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">===</span> <span class="token constant">ANY_PERMISSION</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token constant">ANY_PERMISSION</span><span class="token punctuation">]</span> <span class="token operator">:</span> roles
    resources <span class="token operator">=</span> resources<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">===</span> <span class="token constant">ANY_PERMISSION</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token constant">ANY_PERMISSION</span><span class="token punctuation">]</span> <span class="token operator">:</span> resources
    permissions <span class="token operator">=</span> permissions<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> i <span class="token operator">===</span> <span class="token constant">ANY_PERMISSION</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token constant">ANY_PERMISSION</span><span class="token punctuation">]</span> <span class="token operator">:</span> permissions

    obj <span class="token operator">=</span> <span class="token punctuation">{</span>
        role<span class="token operator">:</span> roles<span class="token punctuation">,</span>
        resource<span class="token operator">:</span> resources<span class="token punctuation">,</span>
        permission<span class="token operator">:</span> permissions
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> obj
<span class="token punctuation">}</span>

<span class="token comment">// 连写形式</span>
<span class="token keyword">const</span> <span class="token function-variable function">ligature</span> <span class="token operator">=</span> <span class="token punctuation">(</span>el<span class="token operator">:</span> HTMLElement<span class="token punctuation">,</span> binding<span class="token operator">:</span> DirectiveBinding<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token keyword">let</span> args <span class="token operator">=</span> binding<span class="token punctuation">.</span>arg
    <span class="token keyword">let</span> modifiers <span class="token operator">=</span> binding<span class="token punctuation">.</span>modifiers
    <span class="token keyword">let</span> values <span class="token operator">=</span> binding<span class="token punctuation">.</span>value

    <span class="token keyword">let</span> expects <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">as</span> Permssion<span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">let</span> servers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">as</span> Permssion<span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果是字符串 比如 &quot;admin&quot; = &gt; &quot;admin:*:*&quot;</span>
        <span class="token comment">// 如果是数组 比如 [&quot;admin&quot;,&quot;user&quot;,&quot;root&quot;] = &gt; [&quot;admin:*:*&quot;,&quot;user:*:*&quot;,&quot;root:*:*&quot;]</span>
        expects <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token function">genRoles</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token constant">PERMISSION_CONNECTION</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>modifiers<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 三种形式</span>
        <span class="token comment">// user</span>
        <span class="token comment">// user:blog</span>
        <span class="token comment">// user:blog:add</span>
        expects <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>expects<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token function">genRoles</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>modifiers<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>


    <span class="token comment">// 服务器接收值</span>
    <span class="token comment">// 连写</span>
    <span class="token keyword">let</span> server<span class="token operator">:</span> Permssion
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isString</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        values <span class="token operator">=</span> <span class="token function">isArray</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span> <span class="token operator">?</span> values<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token constant">PERMISSION_CONNECTION</span><span class="token punctuation">)</span> <span class="token operator">:</span> values
        servers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token function">genRoles</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">]</span>
        server <span class="token operator">=</span> <span class="token function">duplicateRemoval</span><span class="token punctuation">(</span>servers<span class="token punctuation">)</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'连写式写法'</span><span class="token punctuation">,</span> server<span class="token punctuation">)</span>
        <span class="token comment">// 对象式写法</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isObject</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">initParams</span><span class="token punctuation">(</span>values <span class="token keyword">as</span> Permssion<span class="token punctuation">)</span>
        server <span class="token operator">=</span> values
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'对象式写法'</span><span class="token punctuation">,</span> server<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 权限去重与合并</span>
    <span class="token keyword">let</span> expect<span class="token operator">:</span> Permssion <span class="token operator">=</span> <span class="token function">duplicateRemoval</span><span class="token punctuation">(</span>expects<span class="token punctuation">)</span>

    <span class="token comment">// 判断权限</span>

    <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">printPermission</span><span class="token punctuation">(</span>expect<span class="token punctuation">,</span> server<span class="token punctuation">)</span>
        <span class="token function">alertPermission</span><span class="token punctuation">(</span>expect<span class="token punctuation">,</span> server<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasAllPermission</span><span class="token punctuation">(</span>expect<span class="token punctuation">,</span> server<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>



<span class="token comment">// 对象式写法</span>
<span class="token keyword">const</span> <span class="token function-variable function">bindingValueIsObject</span> <span class="token operator">=</span> <span class="token punctuation">(</span>el<span class="token operator">:</span> HTMLElement<span class="token punctuation">,</span> binding<span class="token operator">:</span> DirectiveBinding<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> values <span class="token operator">=</span> binding<span class="token punctuation">.</span>value
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isArray</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span> <span class="token operator">||</span> values<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// throw new Error('v-permission对象式必须式两个对象类型！')</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'v-permission对象式必须式两个对象类型！'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> <span class="token punctuation">[</span>params1<span class="token punctuation">,</span> params2<span class="token punctuation">]</span> <span class="token operator">=</span> values <span class="token keyword">as</span> PermssionType<span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token comment">// console.log(params1, params2, !isUndefined(params1?.type), !isUndefined(params2?.type))</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isUndefined</span><span class="token punctuation">(</span>params1<span class="token operator">?.</span>type<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isUndefined</span><span class="token punctuation">(</span>params2<span class="token operator">?.</span>type<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> params1<span class="token punctuation">.</span>type <span class="token operator">===</span> params2<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'两个类型不能一致！'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 两个参数均为 undefined</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndefined</span><span class="token punctuation">(</span>params1<span class="token operator">?.</span>type<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isUndefined</span><span class="token punctuation">(</span>params2<span class="token operator">?.</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        params1<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token constant">RESOLVE_SERVE</span>
        params2<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token constant">RESOLVE_EXPECT</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 参数一为 undefined</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndefined</span><span class="token punctuation">(</span>params1<span class="token operator">?.</span>type<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> params2<span class="token operator">?.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        params2<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token constant">RESOLVE_SERVE</span> <span class="token operator">?</span> params1<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token constant">RESOLVE_EXPECT</span> <span class="token operator">:</span> params1<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token constant">RESOLVE_SERVE</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 参数二为 undefined</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndefined</span><span class="token punctuation">(</span>params2<span class="token operator">?.</span>type<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> params1<span class="token operator">?.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        params1<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token constant">RESOLVE_SERVE</span> <span class="token operator">?</span> params2<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token constant">RESOLVE_EXPECT</span> <span class="token operator">:</span> params2<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token constant">RESOLVE_SERVE</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 参数初始化</span>
    <span class="token function">initParams</span><span class="token punctuation">(</span>params1<span class="token punctuation">)</span>
    <span class="token function">initParams</span><span class="token punctuation">(</span>params2<span class="token punctuation">)</span>

    <span class="token comment">// 交换，保证 期望值在前</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;before&quot;</span><span class="token punctuation">,</span> params1<span class="token punctuation">.</span>type<span class="token punctuation">,</span> params2<span class="token punctuation">.</span>type<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>params1<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'server'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> temp<span class="token operator">:</span> PermssionType
        temp <span class="token operator">=</span> params1
        params1 <span class="token operator">=</span> params2
        params2 <span class="token operator">=</span> temp
    <span class="token punctuation">}</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;after&quot;</span><span class="token punctuation">,</span> params1<span class="token punctuation">.</span>type<span class="token punctuation">,</span> params2<span class="token punctuation">.</span>type<span class="token punctuation">)</span>

    <span class="token function">alertPermission</span><span class="token punctuation">(</span>params1<span class="token punctuation">,</span> params2<span class="token punctuation">)</span>
    <span class="token function">printPermission</span><span class="token punctuation">(</span>params1<span class="token punctuation">,</span> params2<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasAllPermission</span><span class="token punctuation">(</span>params1<span class="token punctuation">,</span> params2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'我需要隐藏了哦！'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>


<span class="token punctuation">}</span>


<span class="token comment">/**
 * 指令
 */</span>
<span class="token keyword">const</span> vPermission<span class="token operator">:</span> Directive <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">// 或事件监听器应用前调用</span>
    <span class="token function">created</span><span class="token punctuation">(</span>el<span class="token operator">:</span> HTMLElement<span class="token punctuation">,</span> binding<span class="token operator">:</span> DirectiveBinding<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 下面会介绍各个参数的细节</span>
        <span class="token keyword">const</span> arg <span class="token operator">=</span> binding<span class="token punctuation">.</span>arg
        <span class="token keyword">const</span> modifiers <span class="token operator">=</span> binding<span class="token punctuation">.</span>modifiers
        <span class="token keyword">const</span> value <span class="token operator">=</span> binding<span class="token punctuation">.</span>value
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isUndefined</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'value is undefined '</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isEmptyObject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'value is object but not any attr and value '</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> value <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'value is array but length equal 0 '</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 获取参数个数</span>
        el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// 对象式写法</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>arg <span class="token operator">&amp;&amp;</span> <span class="token function">isEmptyObject</span><span class="token punctuation">(</span>modifiers<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">bindingValueIsObject</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> binding<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 连写式写法 | 混合式写法</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arg <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">isEmptyObject</span><span class="token punctuation">(</span>modifiers<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">ligature</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> binding<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'绑定错误'</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> permission <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'permission'</span><span class="token punctuation">,</span>
    directive<span class="token operator">:</span> vPermission
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> permission

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br><span class="line-number">377</span><br><span class="line-number">378</span><br><span class="line-number">379</span><br><span class="line-number">380</span><br><span class="line-number">381</span><br><span class="line-number">382</span><br><span class="line-number">383</span><br><span class="line-number">384</span><br><span class="line-number">385</span><br><span class="line-number">386</span><br><span class="line-number">387</span><br><span class="line-number">388</span><br><span class="line-number">389</span><br><span class="line-number">390</span><br><span class="line-number">391</span><br><span class="line-number">392</span><br><span class="line-number">393</span><br><span class="line-number">394</span><br><span class="line-number">395</span><br><span class="line-number">396</span><br><span class="line-number">397</span><br><span class="line-number">398</span><br><span class="line-number">399</span><br><span class="line-number">400</span><br><span class="line-number">401</span><br><span class="line-number">402</span><br><span class="line-number">403</span><br><span class="line-number">404</span><br><span class="line-number">405</span><br><span class="line-number">406</span><br><span class="line-number">407</span><br><span class="line-number">408</span><br><span class="line-number">409</span><br><span class="line-number">410</span><br><span class="line-number">411</span><br><span class="line-number">412</span><br><span class="line-number">413</span><br><span class="line-number">414</span><br><span class="line-number">415</span><br><span class="line-number">416</span><br><span class="line-number">417</span><br><span class="line-number">418</span><br><span class="line-number">419</span><br><span class="line-number">420</span><br><span class="line-number">421</span><br><span class="line-number">422</span><br><span class="line-number">423</span><br><span class="line-number">424</span><br><span class="line-number">425</span><br><span class="line-number">426</span><br><span class="line-number">427</span><br><span class="line-number">428</span><br><span class="line-number">429</span><br><span class="line-number">430</span><br><span class="line-number">431</span><br></div></div><h2 id="相关链接"><a href="#相关链接" class="header-anchor">#</a> 相关链接</h2> <ul><li><a href="https://gitee.com/xintianyuehui_ln/minecraft-abcserver-web/blob/master/src/directives/permission.ts" target="_blank" rel="noopener noreferrer">源码地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://vuejs.org/guide/reusability/custom-directives.html#directive-hooks" target="_blank" rel="noopener noreferrer">Vue自定义指令<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/wuxin0011/wuxin0011.github.io/edit/main/docs/01.前端/55.前端随笔/03.vue3自定义权限指令.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024-01-12, 22:08:55</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/bem/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">css之bem架构</div></a> <a href="/pages/dhfna5234ew/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">使用Gtihub api 获取用户star项目</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/bem/" class="prev">css之bem架构</a></span> <span class="next"><a href="/pages/dhfna5234ew/">使用Gtihub api 获取用户star项目</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/LeetCode/ans/substring-with-concatenation-of-all-words/"><div>
            前缀树+滑动窗口解决子串问题
            <!----></div></a> <span class="date">01-12</span></dt></dl><dl><dd>02</dd> <dt><a href="/LeetCode/2023_review/"><div>
            LeetCode 2023 年度回顾
            <!----></div></a> <span class="date">12-30</span></dt></dl><dl><dd>03</dd> <dt><a href="/LeetCode/ans/sliding-window-median/"><div>
            二分法解决滑动窗口中位数
            <!----></div></a> <span class="date">12-30</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:2191377759@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/wuxin0011" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://space.bilibili.com/259072250" title="bilibili" target="_blank" class="iconfont icon-bilibili"></a><a href="https://www.cnblogs.com/wuxin001/" title="博客园" target="_blank" class="iconfont icon-bokeyuan"></a><a href="https://juejin.cn/user/2019183212631912" title="掘金" target="_blank" class="iconfont icon-juejin"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2020-2024
    <span>wuxin0011 | <a href="https://github.com/wuxin0011/wuxin0011.github.io" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div data-v-0adae74e><!----> <div class="kbt-row" data-v-0adae74e></div></div><div class="fantasy"><canvas id="cvs" width="1980" height="1080" class="hidden"></canvas> <canvas id="screenImage" width="234" height="357" class="hidden"></canvas> <canvas id="rili" width="600" height="600" class="hidden"></canvas> <canvas id="display"></canvas></div><div></div><div class="index-bigimg" style="display:none;"></div><meting-js server="netease" type="playlist" id="7327522396" fixed="true" theme="#25CCF7" autoPlay="false"></meting-js><div id="tcomment"></div><!----></div></div>
    <script src="/assets/js/app.f77a8ef1.js" defer></script><script src="/assets/js/2.a8c56b49.js" defer></script><script src="/assets/js/59.53ae0f36.js" defer></script><script src="/assets/js/5.a24cbcf3.js" defer></script><script src="/assets/js/6.c8f6b87d.js" defer></script><script src="/assets/js/8.aaf722de.js" defer></script><script src="/assets/js/13.7f9001b0.js" defer></script><script src="/assets/js/9.c3d06476.js" defer></script>
  </body>
</html>
